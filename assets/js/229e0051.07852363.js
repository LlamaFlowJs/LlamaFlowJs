"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4451],{7611:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>d,default:()=>f,frontMatter:()=>c,metadata:()=>h,toc:()=>m});var r=n(65723),a=n(43327),s=n(82468),o=n(29753),i=n(15120),l=n(40253);const u='{\n  "compilerOptions": {\n    "target": "ES2022",\n    "module": "esnext",\n    "moduleResolution": "bundler",\n    "esModuleInterop": true,\n    "forceConsistentCasingInFileNames": true,\n    "strict": true,\n    "skipLibCheck": true,\n    "lib": ["ES2022"],\n    "types": ["node"],\n    "outDir": "./lib",\n    "tsBuildInfoFile": "./lib/.tsbuildinfo",\n    "incremental": true,\n    "composite": true\n  },\n  "ts-node": {\n    "files": true,\n    "compilerOptions": {\n      "module": "commonjs"\n    }\n  },\n  "include": ["./**/*.ts"]\n}\n',c={sidebar_position:1},d="Retrieval Augmented Generation (RAG) Tutorial",h={id:"getting_started/starter_tutorial/retrieval_augmented_generation",title:"Retrieval Augmented Generation (RAG) Tutorial",description:"One of the most common use-cases for llamaflowjs is Retrieval-Augmented Generation or RAG, in which your data is indexed and selectively retrieved to be given to an LLM as source material for responding to a query. You can learn more about the concepts behind RAG.",source:"@site/docs/getting_started/starter_tutorial/retrieval_augmented_generation.mdx",sourceDirName:"getting_started/starter_tutorial",slug:"/getting_started/starter_tutorial/retrieval_augmented_generation",permalink:"/LlamaFlowJs/getting_started/starter_tutorial/retrieval_augmented_generation",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"mySidebar",previous:{title:"Installation and Setup",permalink:"/LlamaFlowJs/getting_started/installation"},next:{title:"Structured data extraction tutorial",permalink:"/LlamaFlowJs/getting_started/starter_tutorial/structured_data_extraction"}},p={},m=[{value:"Set up the project",id:"set-up-the-project",level:2},{value:"Run queries",id:"run-queries",level:2}];function g(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"retrieval-augmented-generation-rag-tutorial",children:"Retrieval Augmented Generation (RAG) Tutorial"}),"\n",(0,r.jsxs)(t.p,{children:["One of the most common use-cases for llamaflowjs is Retrieval-Augmented Generation or RAG, in which your data is indexed and selectively retrieved to be given to an LLM as source material for responding to a query. You can learn more about the ",(0,r.jsx)(t.a,{href:"../concepts",children:"concepts behind RAG"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"set-up-the-project",children:"Set up the project"}),"\n",(0,r.jsx)(t.p,{children:"In a new folder, run:"}),"\n",(0,r.jsxs)(s.A,{groupId:"npm2yarn",children:[(0,r.jsx)(o.A,{value:"npm",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm init\nnpm install -D typescript @types/node\n"})})}),(0,r.jsx)(o.A,{value:"yarn",label:"Yarn",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"yarn init\nyarn add --dev typescript @types/node\n"})})}),(0,r.jsx)(o.A,{value:"pnpm",label:"pnpm",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"pnpm init\npnpm add -D typescript @types/node\n"})})})]}),"\n",(0,r.jsxs)(t.p,{children:["Then, check out the ",(0,r.jsx)(t.a,{href:"../installation",children:"installation"})," steps to install llamaflowjs and prepare an OpenAI key."]}),"\n",(0,r.jsxs)(t.p,{children:["You can use ",(0,r.jsx)(t.a,{href:"../../examples/other_llms",children:"other LLMs"})," via their APIs; if you would prefer to use local models check out our ",(0,r.jsx)(t.a,{href:"../../examples/local_llm",children:"local LLM example"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"run-queries",children:"Run queries"}),"\n",(0,r.jsxs)(t.p,{children:["Create the file ",(0,r.jsx)(t.code,{children:"example.ts"}),". This code will"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"load an example file"}),"\n",(0,r.jsx)(t.li,{children:"convert it into a Document object"}),"\n",(0,r.jsx)(t.li,{children:"index it (which creates embeddings using OpenAI)"}),"\n",(0,r.jsx)(t.li,{children:"create a query engine to answer questions about the data"}),"\n"]}),"\n",(0,r.jsx)(i.A,{language:"ts",children:l.A}),"\n",(0,r.jsxs)(t.p,{children:["Create a ",(0,r.jsx)(t.code,{children:"tsconfig.json"})," file in the same folder:"]}),"\n",(0,r.jsx)(i.A,{language:"json",children:u}),"\n",(0,r.jsx)(t.p,{children:"Now you can run the code with"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npx tsx example.ts\n"})}),"\n",(0,r.jsx)(t.p,{children:"You should expect output something like:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"In college, the author studied subjects like linear algebra and physics, but did not find them particularly interesting. They started slacking off, skipping lectures, and eventually stopped attending classes altogether. They also had a negative experience with their English classes, where they were required to pay for catch-up training despite getting verbal approval to skip most of the classes. Ultimately, the author lost motivation for college due to their job as a software developer and stopped attending classes, only returning years later to pick up their papers.\n\n0: Score: 0.8305309270895813 - I started this decade as a first-year college stud...\n\n\n1: Score: 0.8286388215713089 - A short digression. I\u2019m not saying colleges are wo...\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Once you've mastered basic RAG, you may want to consider ",(0,r.jsx)(t.a,{href:"chatbot",children:"chatting with your data"}),"."]})]})}function f(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},29753:(e,t,n)=>{n.d(t,{A:()=>o});n(22155);var r=n(70851);const a={tabItem:"tabItem_Ge7D"};var s=n(65723);function o(e){let{children:t,hidden:n,className:o}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,o),hidden:n,children:t})}},82468:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(22155),a=n(70851),s=n(32490),o=n(62934),i=n(20189),l=n(38719),u=n(64228),c=n(94040);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}(n);return function(e){const t=(0,u.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const a=(0,o.W6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(a.location.search);t.set(s,e),a.replace({...a.location,search:t.toString()})}),[s,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,s=h(e),[o,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:s}))),[u,d]=m({queryString:n,groupId:a}),[g,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,s]=(0,c.Dv)(n);return[a,(0,r.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:a}),b=(()=>{const e=u??g;return p({value:e,tabValues:s})?e:null})();(0,i.A)((()=>{b&&l(b)}),[b]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)}),[d,f,s]),tabValues:s}}var f=n(47519);const b={tabList:"tabList_pGhr",tabItem:"tabItem_hSrI"};var x=n(65723);function v(e){let{className:t,block:n,selectedValue:r,selectValue:o,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:u}=(0,s.a_)(),c=e=>{const t=e.currentTarget,n=l.indexOf(t),a=i[n].value;a!==r&&(u(t),o(a))},d=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},t),children:i.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>l.push(e),onKeyDown:d,onClick:c,...s,className:(0,a.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:a}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function j(e){const t=g(e);return(0,x.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,x.jsx)(v,{...t,...e}),(0,x.jsx)(y,{...t,...e})]})}function w(e){const t=(0,f.A)();return(0,x.jsx)(j,{...e,children:d(e.children)},String(t))}},40253:(e,t,n)=>{n.d(t,{A:()=>r});const r='import fs from "node:fs/promises";\n\nimport {\n  Document,\n  MetadataMode,\n  NodeWithScore,\n  VectorStoreIndex,\n} from "llamaflowjs";\n\nasync function main() {\n  // Load essay from abramov.txt in Node\n  const path = "node_modules/llamaflowjs/examples/abramov.txt";\n\n  const essay = await fs.readFile(path, "utf-8");\n\n  // Create Document object with essay\n  const document = new Document({ text: essay, id_: path });\n\n  // Split text and create embeddings. Store them in a VectorStoreIndex\n  const index = await VectorStoreIndex.fromDocuments([document]);\n\n  // Query the index\n  const queryEngine = index.asQueryEngine();\n  const { response, sourceNodes } = await queryEngine.query({\n    query: "What did the author do in college?",\n  });\n\n  // Output response with sources\n  console.log(response);\n\n  if (sourceNodes) {\n    sourceNodes.forEach((source: NodeWithScore, index: number) => {\n      console.log(\n        `\\n${index}: Score: ${source.score} - ${source.node.getContent(MetadataMode.NONE).substring(0, 50)}...\\n`,\n      );\n    });\n  }\n}\n\nmain().catch(console.error);\n'}}]);