"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8028],{33991:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var o=t(65723),a=t(43327);const s={},i="A RAG agent that does math",r={id:"guides/agents/rag_and_tools",title:"A RAG agent that does math",description:"In our third iteration of the agent we've combined the two previous agents, so we've defined both sumNumbers and a QueryEngineTool and created an array of two tools:",source:"@site/docs/guides/agents/5_rag_and_tools.mdx",sourceDirName:"guides/agents",slug:"/guides/agents/rag_and_tools",permalink:"/LlamaFlowJs/guides/agents/rag_and_tools",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{},sidebar:"mySidebar",previous:{title:"Adding Retrieval-Augmented Generation (RAG)",permalink:"/LlamaFlowJs/guides/agents/agentic_rag"},next:{title:"Adding LlamaParse",permalink:"/LlamaFlowJs/guides/agents/llamaparse"}},l={},c=[];function u(e){const n={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"a-rag-agent-that-does-math",children:"A RAG agent that does math"}),"\n",(0,o.jsxs)(n.p,{children:["In ",(0,o.jsx)(n.a,{href:"https://github.com/run-llama/ts-agents/blob/main/3_rag_and_tools/agent.ts",children:"our third iteration of the agent"})," we've combined the two previous agents, so we've defined both ",(0,o.jsx)(n.code,{children:"sumNumbers"})," and a ",(0,o.jsx)(n.code,{children:"QueryEngineTool"})," and created an array of two tools:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'// define the query engine as a tool\nconst tools = [\n  new QueryEngineTool({\n    queryEngine: queryEngine,\n    metadata: {\n      name: "san_francisco_budget_tool",\n      description: `This tool can answer detailed questions about the individual components of the budget of San Francisco in 2023-2024.`,\n    },\n  }),\n  FunctionTool.from(sumNumbers, {\n    name: "sumNumbers",\n    description: "Use this function to sum two numbers",\n    parameters: {\n      type: "object",\n      properties: {\n        a: {\n          type: "number",\n          description: "First number to sum",\n        },\n        b: {\n          type: "number",\n          description: "Second number to sum",\n        },\n      },\n      required: ["a", "b"],\n    },\n  }),\n];\n'})}),"\n",(0,o.jsx)(n.p,{children:"These tool descriptions are identical to the ones we previously defined. Now let's ask it 3 questions in a row:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'let response = await agent.chat({\n  message:\n    "What\'s the budget of San Francisco for community health in 2023-24?",\n});\nconsole.log(response);\n\nlet response2 = await agent.chat({\n  message:\n    "What\'s the budget of San Francisco for public protection in 2023-24?",\n});\nconsole.log(response2);\n\nlet response3 = await agent.chat({\n  message:\n    "What\'s the combined budget of San Francisco for community health and public protection in 2023-24?",\n});\nconsole.log(response3);\n'})}),"\n",(0,o.jsx)(n.p,{children:"We'll abbreviate the output, but here are the important things to spot:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"{\n  toolCall: {\n    id: 'call_ZA1LPx03gO4ABre1r6XowLWq',\n    name: 'san_francisco_budget_tool',\n    input: { query: 'community health budget 2023-2024' }\n  },\n  toolResult: {\n    tool: QueryEngineTool {\n      queryEngine: [RetrieverQueryEngine],\n      metadata: [Object]\n    },\n    input: { query: 'community health budget 2023-2024' },\n    output: 'The proposed Fiscal Year (FY) 2023-24 budget for the Department of Public Health is $3.2 billion\n  }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"This is the first tool call, where it used the query engine to get the public health budget."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"{\n  toolCall: {\n    id: 'call_oHu1KjEvA47ER6HYVfFIq9yp',\n    name: 'san_francisco_budget_tool',\n    input: { query: 'public protection budget 2023-2024' }\n  },\n  toolResult: {\n    tool: QueryEngineTool {\n      queryEngine: [RetrieverQueryEngine],\n      metadata: [Object]\n    },\n    input: { query: 'public protection budget 2023-2024' },\n    output: \"The budget for Public Protection in San Francisco for Fiscal Year (FY) 2023-24 is $2,012.5 million.\"\n  }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"In the second tool call, it got the police budget also from the query engine."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"{\n  toolCall: {\n    id: 'call_SzG4yGUnLbv1T7IyaLAOqg3t',\n    name: 'sumNumbers',\n    input: { a: 3200, b: 2012.5 }\n  },\n  toolResult: {\n    tool: FunctionTool { _fn: [Function: sumNumbers], _metadata: [Object] },\n    input: { a: 3200, b: 2012.5 },\n    output: '5212.5',\n    isError: false\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["In the final tool call, it used the ",(0,o.jsx)(n.code,{children:"sumNumbers"})," function to add the two budgets together. Perfect! This leads to the final answer:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"{\n    message: {\n      content: 'The combined budget of San Francisco for community health and public protection in Fiscal Year (FY) 2023-24 is $5,212.5 million.',\n      role: 'assistant',\n      options: {}\n    }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Great! Now let's improve accuracy by improving our parsing with ",(0,o.jsx)(n.a,{href:"llamaparse",children:"LlamaParse"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},43327:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var o=t(22155);const a={},s=o.createContext(a);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);